function Invoke-Telnet {
    param (
        [string]$host,
        [int]$port
    )

    try {
        $tcpClient = New-Object System.Net.Sockets.TcpClient
        $tcpClient.Connect($host, $port)
        
        if ($tcpClient.Connected) {
            Write-Output "✅ Connexion réussie à $host:$port — le trafic est ouvert."
            $tcpClient.Close()
        } else {
            Write-Output "❌ Échec de connexion à $host:$port — le trafic est peut-être bloqué."
        }
    }
    catch {
        Write-Output "⚠️ Erreur lors de la tentative de connexion : $_"
    }
}
