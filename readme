#!/bin/bash
# Script de compilation (utilisant cob2)

echo "Compilation des programmes CHECKER..."

# Boucler sur tous les nouveaux fichiers .cbl
find . -maxdepth 1 -type f -name "*_CHK.cbl" | while read cobol_file; do
    echo "  -> Compilation de $cobol_file..."
    
    # Commande cob2 pour générer le listing sans module objet
    # Assurez-vous d'ajouter ici le chemin de recherche si nécessaire (-qSYSLIB)
    cob2 -qLIST -qNOOBJECT "$cobol_file" > "${cobol_file%.cbl}.lst" 2>&1
    
    if [ $? -eq 0 ]; then
        echo "     [SUCCÈS]"
    else
        echo "     [ERREUR] - Vérifiez le fichier de listing ${cobol_file%.cbl}.lst"
    fi
done

echo "Compilation de masse terminée. Les listings sont prêts pour l'analyse."
